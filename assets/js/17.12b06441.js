(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{200:function(t,a,s){"use strict";s.r(a);var n=s(0),r=Object(n.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_12axios"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_12axios","aria-hidden":"true"}},[t._v("#")]),t._v(" 12axios")]),t._v(" "),s("p",[t._v("axios是对ajax的封装")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("之前的学习中，如何发起数据请求？")]),t._v(" "),s("p",[t._v("最原生的new XMLHttpRequest 对象发起Ajax请求(open send onreadystatechange  readyState responseText)")]),t._v(" "),s("p",[t._v("使用jQuery中提供的工具函数")]),t._v(" "),s("p",[t._v("​\t$.ajax({配置对象})")]),t._v(" "),s("p",[t._v("​\t$.post(url地址, function(){})")]),t._v(" "),s("p",[t._v("​\t$.get(url地址, function(){})")])]),t._v(" "),s("li",[s("p",[t._v("现在用更高端的 axios 来发起Ajax请求")]),t._v(" "),s("p",[t._v("可以支持 get 和 post 等请求，但是无法发起 JSONP 请求，如果涉及到 JSONP 请求，可以让后端启用 cors 跨域资源共享即可")]),t._v(" "),s("blockquote",[s("p",[t._v("jQuery的ajax当然也可以使用，但这样就不得不接受除ajax以外的代码部分，整体考虑不划算")])])])]),t._v(" "),s("h2",{attrs:{id:"下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载","aria-hidden":"true"}},[t._v("#")]),t._v(" 下载")]),t._v(" "),s("p",[t._v("axios参考网址：\nhttps://www.npmjs.com/package/axios")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-aaa.png",alt:""}})]),t._v(" "),s("ol",[s("li",[s("p",[t._v("单独文件下载")]),t._v(" "),s("p",[t._v("浏览器访问如下地址，把获取的内容通过单独的文件存储起来")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("https://unpkg.com/axios/dist/axios.min.js\n")])])])]),t._v(" "),s("li",[s("p",[t._v("cdn方式：")]),t._v(" "),s("p",[t._v("在应用文件中通过如下方式引入axios，要求具备上网环境")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('<script src="https://unpkg.com/axios/dist/axios.min.js"><\/script>\n')])])])]),t._v(" "),s("li",[s("p",[t._v("npm方式：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install axios\n")])])])])]),t._v(" "),s("h2",{attrs:{id:"设置服务器端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置服务器端","aria-hidden":"true"}},[t._v("#")]),t._v(" 设置服务器端")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-bbb.png",alt:""}})]),t._v(" "),s("p",[t._v("项目运行中：")]),t._v(" "),s("ul",[s("li",[t._v("客户端负责数据的"),s("strong",[t._v("展示")])]),t._v(" "),s("li",[t._v("服务器端负责数据的"),s("strong",[t._v("提供")])]),t._v(" "),s("li",[t._v("axios是"),s("font",{attrs:{color:"red"}},[t._v("搬运工")]),t._v("，负责在 客户端 和 服务器端 传输数据")],1)]),t._v(" "),s("p",[t._v("为了使得学习效果更好，现在统一设置"),s("code",[t._v("后端项目")])]),t._v(" "),s("p",[t._v("步骤：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("把server后端项目压缩包解压缩出来")])]),t._v(" "),s("li",[s("p",[t._v("启动mysql数据库")])]),t._v(" "),s("li",[s("p",[t._v("创建目标数据库")])]),t._v(" "),s("li",[s("p",[t._v("给数据库导入数据")])]),t._v(" "),s("li",[s("p",[t._v("给项目安装依赖包  npm install")])]),t._v(" "),s("li",[s("p",[t._v("给项目配置账号、数据库名称和密码(修改src/app.js文件)")])]),t._v(" "),s("li",[s("p",[t._v("运行项目   node app.js")])]),t._v(" "),s("li",[s("p",[t._v("把后端的全部代码文件解压到桌面指定目录")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561016785365.png",alt:"1561016785365"}})])]),t._v(" "),s("li",[s("p",[t._v("启动mysql")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-1554629441784.png",alt:"1554629441784"}})])]),t._v(" "),s("li",[s("p",[t._v("创建数据库相关")]),t._v(" "),s("p",[t._v("新建数据库：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561016897179.png",alt:"1561016897179"}})]),t._v(" "),s("p",[t._v("给数据库导入数据：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561016973984.png",alt:"1561016973984"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561016949657.png",alt:"1561016949657"}})]),t._v(" "),s("p",[t._v("数据导入成功：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561017013901.png",alt:"1561017013901"}})])]),t._v(" "),s("li",[s("p",[t._v("给项目配置数据库信息")]),t._v(" "),s("p",[t._v("在src/app.js文件中根据实际情况配置 数据库用户名、密码、数据库名称")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/1561017218181.png",alt:"1561017218181"}})])]),t._v(" "),s("li",[s("p",[t._v("给项目安装全部依赖包")]),t._v(" "),s("p",[t._v("在"),s("strong",[t._v("server")]),t._v("目录下运行 npm install")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install\n")])])]),s("p",[s("img",{attrs:{src:"/img/1561017337257.png",alt:"1561017337257"}})])]),t._v(" "),s("li",[s("p",[t._v("运行项目")]),t._v(" "),s("p",[t._v("在server/src目录下运行 node app.js")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("node app.js\n")])])]),s("p",[s("img",{attrs:{src:"/img/1561017520017.png",alt:"1561017520017"}})])]),t._v(" "),s("li",[s("p",[t._v("浏览器运行效果：")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-1554630006862.png",alt:"1554630006862"}})]),t._v(" "),s("h2",{attrs:{id:"使用axios"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用axios","aria-hidden":"true"}},[t._v("#")]),t._v(" 使用axios")]),t._v(" "),s("h3",{attrs:{id:"get请求语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get请求语法","aria-hidden":"true"}},[t._v("#")]),t._v(" get请求语法")]),t._v(" "),s("p",[t._v("语法")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("地址"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("params"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("被传递的数据"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("如果需要给服务器传递参数，就需要借助params成员")])]),t._v(" "),s("h3",{attrs:{id:"post请求语法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#post请求语法","aria-hidden":"true"}},[t._v("#")]),t._v(" post请求语法")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const result = axios.post(地址,{被传递的数据})\n")])])]),s("blockquote",[s("p",[t._v("如果需要给服务端传递参数，可以借助post方法的第二个参数，被传递的参数要求是 对象 格式")])]),t._v(" "),s("p",[t._v("注意：")]),t._v(" "),s("p",[t._v("axios调用全部方法返回的结果都是Promise对象，本身可以再调用then或catch方法做进一步处理")]),t._v(" "),s("h2",{attrs:{id:"axios配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#axios配置","aria-hidden":"true"}},[t._v("#")]),t._v(" axios配置")]),t._v(" "),s("p",[t._v("1.把axios配置成为Vue的一个"),s("a",{attrs:{href:""}},[t._v("子成员")]),t._v("，每次都通过Vue触发调用，以便Vue主角可以控制一切")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$http "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios\t\t\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$http"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\t\t\t   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用")]),t._v("\n")])])]),s("blockquote",[s("p",[s("code",[t._v("$http")]),t._v("是vue指向axios的成员名称，可以自定义为其它")])]),t._v(" "),s("p",[t._v("2.给axios设置请求"),s("a",{attrs:{href:""}},[t._v("公共根地址")]),t._v("，这样可以减少重复代码编写，提升项目开发效率 、 增强维护性")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseURL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'根地址'")]),t._v("\n")])])]),s("h2",{attrs:{id:"axios拦截器interceptors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#axios拦截器interceptors","aria-hidden":"true"}},[t._v("#")]),t._v(" axios拦截器interceptors")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-4-333.png",alt:""}})]),t._v(" "),s("p",[t._v("axios在客户端与服务端之间传递数据时候是有时间消耗的")]),t._v(" "),s("p",[t._v("网络好、服务器比较空闲，axios的执行速度快")]),t._v(" "),s("p",[t._v("网络不好、服务器比较繁忙，axios的执行速度慢(这时用户需要多等待)")]),t._v(" "),s("p",[t._v("axios无论执行速度快还是慢，用户都需要等待，如果在axios执行过程中页面给予一定的提示，那么用户体验就比较好，这时候"),s("a",{attrs:{href:""}},[t._v("拦截器")]),t._v("就可以应用上")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/2-4-444.png",alt:""}})]),t._v(" "),s("p",[t._v("axios本身有两种拦截器："),s("a",{attrs:{href:""}},[t._v("请求拦截")]),t._v("、"),s("a",{attrs:{href:""}},[t._v("响应拦截")])]),t._v(" "),s("ul",[s("li",[t._v("请求拦截器：")])]),t._v(" "),s("p",[t._v("​\taxios每次"),s("font",{attrs:{color:"red"}},[t._v("开始")]),t._v("请求的时候先执行此处逻辑，在这个地方可以给axios做出发前的配置，也可以做出发前的检查工作，检查ok的情况下就开始向服务器端发请求")],1),t._v(" "),s("ul",[s("li",[t._v("响应拦截器：")])]),t._v(" "),s("p",[t._v("​\taxios"),s("font",{attrs:{color:"red"}},[t._v("完成")]),t._v("与服务器端交互回到客户端后就执行此处逻辑，在这个地方可以做一些后续收尾事宜，例如axios每次请求是否成功的判断处理")],1),t._v(" "),s("p",[t._v("请求拦截器")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// axios请求前的逻辑处理")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("config 代表axios请求的配置对象，后期可以借此给axios做相关配置")])]),t._v(" "),s("p",[t._v("响应拦截器")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("axios"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// axios完整请求的后续逻辑处理")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Do something with response error")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Promise"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("response代表服务器端给axios返回的信息，可以做响应完毕的后续处理工作")])]),t._v(" "),s("h2",{attrs:{id:"等待案例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#等待案例","aria-hidden":"true"}},[t._v("#")]),t._v(" 等待案例")]),t._v(" "),s("p",[t._v("为了使得用户体验更好，在进行axios请求过程中要求提示等待效果")]),t._v(" "),s("p",[t._v("实现：发送axios请求的时候"),s("strong",[t._v("显示")]),t._v("等待图片，完成请求就"),s("strong",[t._v("隐藏")]),t._v("等待图片")]),t._v(" "),s("p",[t._v("步骤：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("把loading.gif图片放到应用目录，并通过img标签做应用，同时通过v-show实现img标签的显示和隐藏效果")])]),t._v(" "),s("li",[s("p",[t._v("在Vue的data成员中设置flag标志")])]),t._v(" "),s("li",[s("p",[t._v("在created生命周期中设置请求、响应拦截器，做flag布尔值的切换操作")]),t._v(" "),s("p",[t._v("(预想：在请求拦截器中设置flag=true，在相应拦截器中设置flag=false,效果即呈现)")])])]),t._v(" "),s("p",[t._v("涉及技术点：")]),t._v(" "),s("p",[t._v("最好使用v-show，因为等待效果的切换比较频繁，用v-show更节省资源")]),t._v(" "),s("h2",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结","aria-hidden":"true"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),s("ol",[s("li",[t._v("axios所有请求的返回结果都可以通过  "),s("strong",[t._v("async/await")]),t._v("  修饰")]),t._v(" "),s("li",[s("strong",[t._v("对象解构赋值")]),t._v(" 使得对象中的个别成员可以单独拆分出来独立使用")]),t._v(" "),s("li",[t._v("axios的请求"),s("strong",[t._v("公共前缀地址")]),t._v("可以做统一配置，使得相同的部分只维护一份，提升开发效率")]),t._v(" "),s("li",[t._v("axios可以配置为Vue的成员，使得应用风格统一")])]),t._v(" "),s("ul",[s("li",[t._v("axios的拦截器为了可以操控Vue实例的data数据，需要设置到created生命周期方法中，在该方法中data数据已经准备好了")])])])},[],!1,null,null,null);a.default=r.exports}}]);